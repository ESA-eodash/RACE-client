import{ay as O,az as Y,T as H,aA as U,m as _,E as q,aB as E,aC as G,r as P,c as J,aD as K,Q as L,aE as Q,w as Z,aF as I,aG as k,aH as F,Y as W,aI as X,a1 as V,b as g,aJ as ee,a0 as y,a4 as f,aK as M,U as te,$ as p,a7 as b,j as C,a3 as v,Z as D,V as S,N as A,aL as R,aM as ae,aN as j,aO as se}from"./index-2WmxvTWX.js";import{V as ne}from"./VTooltip-VB078zTJ.js";import"./VOverlay-AvWeBXR2.js";import"./forwardRefs-BanhaVDb.js";import"./transition-CRVvvm1o.js";function oe(a,r){const c=typeof a=="string"?O(a):a,s=re(c,r);return{mounted:s,updated:s,unmounted(i){Y(null,i)}}}function re(a,r){return function(c,s,i){const d=typeof r=="function"?r(s):r,n=s.value?.text??s.value??d?.text,u=H(s.value)?s.value:{},$=()=>n??c.textContent,m=(i.ctx===s.instance.$?le(i,s.instance.$)?.provides:i.ctx?.provides)??s.instance.$.provides,x=U(a,_(d,u),$);x.appContext=Object.assign(Object.create(null),s.instance.$.appContext,{provides:m}),Y(x,c)}}function le(a,r){const c=new Set,s=d=>{for(const n of d){if(!n)continue;if(n===a||n.el&&a.el&&n.el===a.el)return!0;c.add(n);let u;if(n.suspense?u=s([n.ssContent]):Array.isArray(n.children)?u=s(n.children):n.component?.vnode&&(u=s([n.component?.subTree])),u)return u;c.delete(n)}return!1};if(!s([r.subTree]))return r;const i=Array.from(c).reverse();for(const d of i)if(d.component)return d.component;return r}const T=oe(ne,a=>({activator:"parent",location:a.arg?.replace("-"," "),text:typeof a.value=="boolean"?void 0:a.value})),ie={ref:"rootRef",class:"datePicker"},ce={class:"bg-surface d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},de={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ue=["value"],fe={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},me={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},pe=["value"],we={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(a){te(o=>({"45a34dce":z.value}));const{lgAndDown:r}=q(),c=E("rootRef"),s=E("datePicker"),i=G((o,e)=>({get(){return o(),new Date(M.value).getTime()},set(t){e(),I.debug("Datepicker setting currentDate",M.value);const l=new Date(t);M.value=l.toISOString(),s.value?.move({month:l.getMonth()+1,year:l.getFullYear()})}})),d=P({input:"YYYY-MM-DD"}),n=o=>{const e=o.getFullYear(),t=o.getMonth()+1,l=o.getDate();return`${e}-${t<10?"0"+t:t}-${l<10?"0"+l:l}`},u=o=>{i.value=new Date(o.target?.value).getTime()},$=J(()=>n(new Date(i.value))),m=K([]),x=L(Q(),"selectedStac");Z(x,async(o,e)=>{if(o&&e?.id!==o.id){I.debug("Datepicker selected STAC change triggered"),m.splice(0,m.length);for(let t=0;t<k.length;t++){I.debug("Retrieving dates",k[t]),await k[t].fetchCollection();const l=[...new Set(k[t].getItems()?.reduce((h,N)=>{const B=Date.parse(N.datetime);return B&&h.push(new Date(B)),h},[]))];m.push({key:"id-"+t.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:F[t%F.length]}},dates:l,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function w(o){if(m.length){let e=o?1/0:-1/0;m.forEach(t=>{t?.dates&&t.dates.forEach(l=>{l instanceof Date&&(e=Math[o?"min":"max"](e,l.getTime()))})}),i.value=e===-1/0?Date.now():e===1/0?0:e}}const z=P("");return W(()=>{z.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),X(c),(o,e)=>(p(),V("div",ie,[g(f(se),{ref:"datePicker",modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value=t),modelModifiers:{number:!0},attributes:m,masks:d.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},ee({_:2},[a.toggleCalendar?{name:"default",fn:y(({inputValue:t,inputEvents:l})=>[b("div",ce,[a.hideArrows?v("v-if",!0):C((p(),D(S,{key:0,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=h=>w(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:y(()=>[g(A,{icon:[f(R)]},null,8,["icon"])]),_:1},8,["size"])),[[T,"Set date to oldest available dataset","bottom"]]),b("div",de,[a.hideInputField?v("v-if",!0):(p(),V("input",_({key:0,value:t},ae(l,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,ue))]),a.hideArrows?v("v-if",!0):C((p(),D(S,{key:1,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=h=>w(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:y(()=>[g(A,{icon:[f(j)]},null,8,["icon"])]),_:1},8,["size"])),[[T,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:y(()=>[b("div",fe,[a.hideArrows?v("v-if",!0):C((p(),D(S,{key:0,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=t=>w(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:y(()=>[g(A,{icon:[f(R)]},null,8,["icon"])]),_:1},8,["size"])),[[T,"Set date to oldest available dataset","bottom"]]),b("div",me,[a.hideInputField?v("v-if",!0):(p(),V("input",{key:0,value:$.value,onChange:u,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,pe))]),a.hideArrows?v("v-if",!0):C((p(),D(S,{key:1,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=t=>w(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:y(()=>[g(A,{icon:[f(j)]},null,8,["icon"])]),_:1},8,["size"])),[[T,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{we as default};
